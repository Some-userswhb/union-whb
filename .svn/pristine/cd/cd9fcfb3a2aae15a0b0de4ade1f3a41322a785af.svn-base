<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>添智·智慧工会云服务平台</title>
    <meta name="keywords">
    <meta name="description">
    <link rel="shortcut icon" href="favicon.ico">
    <link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link href='css/nprogress.css' rel='stylesheet' />

    <!-- Morris -->
    <link href="css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css?v=4.1.0" rel="stylesheet">
    <link href="css/combo.select.css" rel="stylesheet">
    <link href="css/plugins/treeview/bootstrap-treeview.css" rel="stylesheet">
    <link href="css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <link href="css/plugins/iCheck/custom.css" rel="stylesheet">
    <!-- Data Tables -->
    <link href="css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">
</head>
<body class="gray-bg sidebar-content">
<style>
    .dataTables-example td, .dataTables-example th {
        padding: 8px 0 !important;
    }
    .layui-layer-setwin .layui-layer-close2{
        right: -6px;
        top: -11px;
    }
    #unionChange {
        height: 500px;
        overflow-y: scroll;
        position: relative;
    }

    .file-add {
        padding-top: 20px;
    }

    .butt-right {
        width: 28%;
    }

    .file-operating li {
        float: left;
        margin-left: 5px;
    }

    .btn-group {
        width: 210px;
        height: 39px;
        margin-bottom: 12px;
    }

    .btn-default.active.focus, .btn-default.active:focus,
    .btn-default.active:hover, .btn-default:active.focus,
    .btn-default:active:focus, .btn-default:active:hover,
    .open > .dropdown-toggle.btn-default.focus, .open > .dropdown-toggle.btn-default:focus,
    .open > .dropdown-toggle.btn-default:hover {
        background-color: white;
    }

    .btn-default:hover, .btn-default:focus, .btn-default:active,
    .btn-default.active, .open .dropdown-toggle.btn-default {
        background-color: white;
    }

    .btn-default.active, .btn-default:focus, .btn-default:hover {
        background-color: white;
    }
    .btn-group input {
        width: 100%;
        height: 40px;
        background-color: white;
        font-size: 12px !important;
        text-align: left;
        cursor: text;
    }
    .btn-group .dropdown-menu {
        width: 210px;
        height: 200px;
        overflow: hidden;
        overflow-y: scroll;
        border-radius:2px;
    }
    .btn-group .dropdown-menu li {
        width: 100%;
        height: 35px;
        line-height: 35px;
        padding-left: 10px;
        border-bottom: 1px solid #e6e6e6;
        font-size: 14px;
        cursor: pointer;
    }
    .btn-group .dropdown-menu li:hover {
        background-color: #1b6d85;
        color: white;
    }
    .input-sm {
        height: 40px !important;
    }
    .input-sm option {
        width: 100%;
        height: 40px !important;
    }
    .table-wrap{
        width: 100%;
        height: 500px;
        overflow-y: auto;

    }
    .table-wrap::-webkit-scrollbar {
        width: 3px;

    }
    .padleftnone{
        padding-left: 0;
    }
    #tab-1-7 .col-sm-8 input{
        width: 50%;
    }
    .zhu-red{
        color: red;
        margin-top: 20px;
    }

</style>
<div id="treeGhlist" v-cloak>
    <div class="sidebard-panel">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>工会列表</h5>
                </div>
                <div class="unlist-wrap">
                    <div class="btn-group">
                        <input class="btn btn-default btn-lg dropdown-toggle"
                               type="text" data-toggle="dropdown"
                               v-model="searchVal"
                               aria-haspopup="true"
                               :placeholder="placename"
                               aria-expanded="true"></input>
                        <ul class="dropdown-menu">
                            <li v-for="(item,key) in Ghlist"
                                @click="showDetails(item.laborun_code)
                               ">{{item.laborun_name}}
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="ibox-content">
                    <div id="treeLaborun" class="test"></div>
                    <div class="iconshow">
                          <ul class="no-padding">
                              <div class="iconshow">
                                  <h5>图标说明：</h5>
                                  <ul class="no-padding">
                                      <li>
                                          <i class="fa fa fa-sitemap"></i>
                                          <span class="nav-label">组织工会</span>
                                      </li>
                                      <li><i class="fa fa fa-database"></i>
                                          <span class="nav-label">产业工会</span></li>
                                      <li><i class="fa fa fa-building"></i>
                                          <span class="nav-label">企事业工会</span></li>
                                  </ul>
                              </div>
                          </ul>
                      </div>
                </div>
            </div>
        </div>
    </div>
    <div class="wrapper wrapper-content animated fadeIn">
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>{{ Detailslist.laborunName }}</h5>
                    </div>
                    <div class="ibox-content">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="tabs-container">
                                    <ul class="nav nav-tabs ">
                                        <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true">工会详情</a></li>
                                        <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">基层工会</a></li>
                                    </ul>
                                    <div class="tab-content">
                                        <!--工会详情选项卡开始-->
                                        <div id="tab-1" class="tab-pane active">
                                            <div class="panel-body">
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="tabs-container">
                                                            <ul class="nav nav-tabs">
                                                                <li class="active"><a data-toggle="tab" href="#tab-1-1" aria-expanded="true"> 基本信息</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-2" aria-expanded="false"  @click="querylaborunLegal">法人资格</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-3" aria-expanded="false" @click="queryLaborunChRecord">工会变更</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-4" @click="queryLaborunFilesRecord(2)" aria-expanded="false">资质管理</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-5" @click="queryFilesRecord2(3)" aria-expanded="false">文件档案</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-6" @click="queryDuty()" aria-expanded="false">任职管理</a></li>
                                                                <li class=""><a data-toggle="tab" href="#tab-1-7" @click="queryAccount()" aria-expanded="false">账户管理</a></li>
                                                            </ul>
                                                            <div class="tab-content">
                                                                <div id="tab-1-1" class="tab-pane active">
                                                                    <div class="panel-body table-scroll"
                                                                         id="unionDetails"
                                                                         v-cloak>
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <div class="table-responsive">
                                                                                    <table class="table table-striped table-hover no-bottom">
                                                                                        <tbody>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会名称 :
                                                                                            </td>
                                                                                            <td class="no-top-border">{{Detailslist.laborunName}}</td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会编号 :
                                                                                            </td>
                                                                                            <td class="no-top-border">{{Detailslist.laborunCode}}</td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                建会时间 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.establishTime}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                行政区划 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.administratName}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会地址 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.laborunAddr}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback" style="display: none" id="unitTypeclass">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                单位类型:
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.unitTypeText}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会状态 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.laborunStatusText}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会备注 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.remark}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>
                                                                            <!--工会编号-->
                                                                            <div class="col-sm-6">
                                                                                <div class="table-responsive">
                                                                                    <table class="table table-striped table-hover no-bottom">
                                                                                        <tbody>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会分类 :
                                                                                            </td>
                                                                                            <td class="no-top-border">{{Detailslist.laborunKindText}}</td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会级别 :
                                                                                            </td>
                                                                                            <td class="no-top-border">{{Detailslist.laborunLevelText}}</td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                工会类型 :
                                                                                            </td>
                                                                                            <td class="no-top-border"> {{Detailslist.laborunTypeText}}</td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                上级工会 :
                                                                                            </td>
                                                                                            <td class="no-top-border text-nowrap">
                                                                                                {{Detailslist.parentLaborunName}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap" style="display: none" id="buildWayclass">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                组建方式 :
                                                                                            </td>
                                                                                            <td class="no-top-border text-nowrap">
                                                                                                {{Detailslist.buildWayText}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                负责人 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.principal}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback text-nowrap">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                负责人电话 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.principalPhone}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-3">
                                                                                                职工人数:
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{Detailslist.workers}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!--工会详情 基本信息-->
                                                                        <div class="row">
                                                                            <div class="col-sm-12">
                                                                                <div class="table-responsive" id="unitClass" style="display: none">
                                                                                    <table class="table table-striped table-hover">
                                                                                        <tbody>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border top-left"
                                                                                                style="width: 12%">工会单位
                                                                                                :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                <table class="table table-bordered">
                                                                                                    <thead>
                                                                                                    <tr>
                                                                                                        <th>单位名称</th>
                                                                                                        <th>统一社会信用代码</th>
                                                                                                        <th>单位类型</th>
                                                                                                        <th>负责人</th>
                                                                                                        <th>负责人电话</th>
                                                                                                    </tr>
                                                                                                    </thead>
                                                                                                    <tbody>
                                                                                                    <tr v-for="item in Detailslist.unitList">
                                                                                                        <td>{{item.unitName}}</td>
                                                                                                        <td>{{item.socialCreditCode}}</td>
                                                                                                        <td>{{item.unitTypeText}}</td>
                                                                                                        <td>{{item.principal}}</td>
                                                                                                        <td>{{item.principalPhone}}</td>
                                                                                                    </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>
                                                                            <!--<div class="col-sm-12">
                                                                                <div class="ibox float-e-margins"
                                                                                     style="margin-top: 25px">
                                                                                    <p style="text-align: center;">
                                                                                        <button name="perm" data-toggle="modal"
                                                                                           class="btn btn-primary"
                                                                                           style="text-align: left;"
                                                                                           href="#modal-formo">建会</button>
                                                                                        <button name="perm" type="button"
                                                                                                class="btn  btn-primary"
                                                                                                onclick="transfer()">转移
                                                                                        </button>
                                                                                        <button name="perm" type="button"
                                                                                                class="btn  btn-primary"
                                                                                                onclick="merge()">合并
                                                                                        </button>
                                                                                        <button name="perm" type="button"
                                                                                                class="btn  btn-primary"
                                                                                                onclick="dissolve()">解散
                                                                                        </button>
                                                                                    </p>
                                                                                </div>
                                                                            </div>-->
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--法人资格-->
                                                                <div id="tab-1-2" class="tab-pane">
                                                                    <div class="panel-body" id="updateLeaGelCalss" style="display:none">
                                                                        <div style="margin-left: 20px">
                                                                            <button type="button" name="perm" class="btn  btn-primary" onclick="updateLegal()">变更法人资格</button>
                                                                            <button type="button" name="perm" class="btn  btn-primary" onclick="legelRecord()">变更记录
                                                                            </button>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-sm-12">
                                                                                <div class="table-responsive">
                                                                                    <table class="table table-hover">
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-1 text-nowrap"
                                                                                                style="width: 12%">法人信息
                                                                                                :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                <table class="table table-bordered">
                                                                                                    <thead>
                                                                                                    <tr>
                                                                                                        <th>法人姓名</th>
                                                                                                        <th>会员证号</th>
                                                                                                        <th>证件号</th>
                                                                                                        <th>工会职务</th>
                                                                                                    </tr>
                                                                                                    </thead>
                                                                                                    <tbody>
                                                                                                    <tr>
                                                                                                        <td>
                                                                                                            {{leageldata.memName}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.memNumber}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.cardNo}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.dutyName}}
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-2 text-nowrap">
                                                                                                统一社会信用代码 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{leageldata.socialCreditCode}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border top-left text-nowrap"
                                                                                                style="width: 10%">收入信息
                                                                                                :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                <table class="table table-bordered">
                                                                                                    <thead>
                                                                                                    <tr>
                                                                                                        <th>上年结余累计</th>
                                                                                                        <th>年会员会费</th>
                                                                                                        <th>年2%经费留成</th>
                                                                                                        <th>其他收入</th>
                                                                                                    </tr>
                                                                                                    </thead>
                                                                                                    <tbody>
                                                                                                    <tr>
                                                                                                        <td>
                                                                                                            {{leageldata.lastYearBalance}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.annualMemsFee}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.annualFunds}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.otherIncome}}
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border top-left text-nowrap"
                                                                                                style="width: 10%">资金情况
                                                                                                :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                <table class="table table-bordered">
                                                                                                    <thead>
                                                                                                    <tr>
                                                                                                        <th>合计</th>
                                                                                                        <th>固定资金</th>
                                                                                                        <th>流动资金</th>
                                                                                                        <th>其他</th>
                                                                                                    </tr>
                                                                                                    </thead>
                                                                                                    <tbody>
                                                                                                    <tr>
                                                                                                        <td>
                                                                                                            {{capitalSum}}
                                                                                                        </td>
                                                                                                        <td>{{
                                                                                                            leageldata.fixedCapital
                                                                                                            }}
                                                                                                        </td>
                                                                                                        <td>{{
                                                                                                            leageldata.workingCapital
                                                                                                            }}
                                                                                                        </td>
                                                                                                        <td>{{
                                                                                                            leageldata.otherCapital
                                                                                                            }}
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border top-left text-nowrap"
                                                                                                style="width: 10%">场所情况
                                                                                                :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                <table class="table table-bordered">
                                                                                                    <thead>
                                                                                                    <tr>
                                                                                                        <th>合计</th>
                                                                                                        <th>办公场所</th>
                                                                                                        <th>活动场所</th>
                                                                                                        <th>其他场所</th>
                                                                                                    </tr>
                                                                                                    </thead>
                                                                                                    <tbody>
                                                                                                    <tr>
                                                                                                        <td>
                                                                                                            {{officeSum}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.office}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.activities}}
                                                                                                        </td>
                                                                                                        <td>
                                                                                                            {{leageldata.otherPlace}}
                                                                                                        </td>
                                                                                                    </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr class="nback">
                                                                                            <td class="client-link no-top-border col-sm-1 text-nowrap">
                                                                                                民事责任 :
                                                                                            </td>
                                                                                            <td class="no-top-border">
                                                                                                {{leageldata.civilLiability}}
                                                                                            </td>
                                                                                        </tr>
                                                                                        </tbody>
                                                                                    </table>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="panel-body" id="addLeaGelCalss"  style="display:none">
                                                                        <div style="margin-left: 20px">
                                                                            <button type="button" name="perm" class="btn  btn-primary" onclick="addLegal()">添加法人资格</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--工会变更-->
                                                                <div id="tab-1-3" class="tab-pane" v-cloak>
                                                                    <div class="panel-body">
                                                                        <div class="table-wrap">

                                                                        <table class="table table-bordered">
                                                                            <thead class="tab-fiexd">
                                                                            <tr>
                                                                                <th>变更</th>
                                                                                <th>变更时间</th>
                                                                                <th>变更项</th>
                                                                                <th>操作备注</th>
                                                                            </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                            <tr v-for="(item,name) in unionCh">
                                                                                <td>{{item.changeTypeText}}</td>
                                                                                <td>{{item.applyTime}}</td>
                                                                                <td>{{item.changeConcent}}</td>
                                                                                <td>{{item.remark}}</td>

                                                                            </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--资质管理-->
                                                                <div id="tab-1-4" class="tab-pane">
                                                                    <div class="file-add">
                                                                        <div style="margin-left: 20px">
                                                                            <button  name="perm" type="button" class="btn  btn-primary" onclick="addfile(2)">添加</button>
                                                                        </div>
                                                                        <table class="table table-striped  table-hover fileRecord"
                                                                               id="fileRecord">
                                                                            <thead>
                                                                            <tr>
                                                                                <th>文件名称</th>
                                                                                <th>文件</th>
                                                                                <th>文件分类</th>
                                                                                <th>操作</th>
                                                                            </tr>
                                                                            </thead>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <!--文件档案-->
                                                                <div id="tab-1-5" class="tab-pane" v-cloak>
                                                                    <div class="file-add">
                                                                        <div style="margin-left: 20px">
                                                                            <button  name="perm" type="button" class="btn  btn-primary" onclick="addfile(3)">添加
                                                                            </button>
                                                                        </div>
                                                                        <table class="table table-striped  table-hover"
                                                                               id="fileRecord2">
                                                                            <thead>
                                                                            <tr>
                                                                                <th>文件名称</th>
                                                                                <th>文件</th>
                                                                                <th>文件分类</th>
                                                                                <th>操作</th>
                                                                            </tr>
                                                                            </thead>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <!--任职管理-->
                                                                <div id="tab-1-6" class="tab-pane">
                                                                    <div class="file-add">
                                                                        <div style="margin-left: 20px">
                                                                            <button  name="perm" type="button" class="btn  btn-primary" onclick="addDuty()">添加
                                                                            </button>
                                                                            <button  name="perm" type="button" class="btn  btn-primary" onclick="getDutyRecord()">任职记录
                                                                            </button>
                                                                        </div>
                                                                        <table class="table table-striped  table-hover "
                                                                               id="queryDuty">
                                                                            <thead>
                                                                            <tr>
                                                                                <th>工会职务</th>
                                                                                <th style="white-space: nowrap">任职人员</th>
                                                                                <th>会员证号</th>
                                                                                <th>任职时间</th>
                                                                                <th>操作</th>
                                                                            </tr>
                                                                            </thead>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <!--账户管理-->
                                                                <div id="tab-1-7" class="tab-pane">
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <form class="form-horizontal m-t" id="accountForm">
                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">用户账户：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <input id="userName" name="userName" v-model="accountData.userName"
                                                                                               class="form-control" type="text" placeholder="请输入账户名称">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">用户密码：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <input id="password" name="password" v-model="accountData.password"
                                                                                               class="form-control" type="password" placeholder="请输入用户密码">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">姓名：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <input name="realName" id="realName" v-model="accountData.realName" class="form-control" type="text" placeholder="请输入真实姓名">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">联系方式：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <input name="phone" id="phone" v-model="accountData.phone" class="form-control" type="text" placeholder="请输入联系方式">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">账号状态：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <select class="form-control" name="status" v-model="accountData.status" id="status" style="width: 50%;">
                                                                                            <option :value="1">启用</option>
                                                                                            <option :value="0">停用</option>
                                                                                        </select>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="form-group">
                                                                                    <label class="col-sm-3 control-label">备注：</label>
                                                                                    <div class="col-sm-8">
                                                                                        <textarea id="remark" name="remark" v-model="accountData.remark" class="form-control"
                                                                                                  style="resize: none;width: 50%" placeholder="最多输入200字"></textarea>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="form-group">
                                                                                    <div class="col-sm-8 col-sm-offset-3">

                                                                                        <p class="zhu-red">注: &nbsp;&nbsp;&nbsp;此账号的权限只限本工会超级管理员权限</p>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-group">
                                                                                    <div class="col-sm-8 col-sm-offset-3">
                                                                                        <button class="btn btn-primary" type="submit" value="保存">保存</button>
                                                                                    </div>
                                                                                </div>
                                                                            </form>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--基层工会选项卡开始-->
                                            <div id="tab-2" class="tab-pane">
                                                <div class="panel-body">
                                                    <div class="ibox float-e-margins">
                                                        <div class="ibox-content">
                                                            <div class="row" id="nameselect" v-cloak>
                                                                <div class="col-sm-4 no-padding">
                                                                    <div class="col-sm-4 lin-h40 wid27  no-padding client-link">
                                                                        工会名称：
                                                                    </div>
                                                                    <div class="col-sm-8   no-padding UnionName">
                                                                        <select class="input-sm form-control input-s-sm inline" id="laborunName">
                                                                            <option value="">请选择</option>
                                                                            <option value="0" v-for="(item,name) in Ghlist">{{item.laborun_name}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-4 no-padding ">
                                                                    <div class="col-sm-4 wid27 no-padding lin-h40 client-link">工会编号：
                                                                    </div>
                                                                    <div class="col-sm-8  no-padding UnionCode">
                                                                        <select class="input-sm form-control input-s-sm inline" id="laborunCode">
                                                                            <option value="">请选择</option>
                                                                            <option value="0" v-for="(item,name) in Ghlist">{{item.laborun_code}}</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-4 no-padding">
                                                                    <div class="col-sm-12 no-padding">
                                                                        <button type="button" class="btn  btn-primary mar-r15" onclick="Search()">
                                                                            搜索
                                                                        </button>
                                                                        <button type="button" class="btn  btn-primary mar-r15" id="reset">
                                                                            重置
                                                                        </button>
                                                                        <a href="javacript:void(0)" class="more"><span
                                                                                class="lin-h40">高级搜索></span></a>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-12 no-padding disn morecheackboxo">
                                                                    <div class="col-sm-1 wid9  no-padding  client-link lin-h40">
                                                                        工会类型：
                                                                    </div>
                                                                    <div class="form-group lin-h40 col-sm-10 padleftnone">
                                                                        <div class="col-sm-12 padleftnone">
                                                                            <label class="checkbox-inline i-checks">
                                                                                <input  type="checkbox" value="option1" class="allCheck" name="laborunTypeall">全部
                                                                            </label>
                                                                            <label class="checkbox-inline i-checks" v-for="index in laborunTypes">
                                                                                <input name="laborunTypecheck" :code="index.value" type="checkbox" value="index.value">{{index.name}}</label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-12 no-padding disn morecheackboxt">
                                                                    <div class="col-sm-1 wid9  no-padding  client-link lin-h40">
                                                                        工会级别：
                                                                    </div>
                                                                    <div class="form-group lin-h40 col-sm-10 padleftnone">
                                                                        <div class="col-sm-12 padleftnone">
                                                                            <label class="checkbox-inline i-checks">
                                                                                <input type="checkbox" class="allCheck" value="option1" name="laborunLevelall">全部</label>
                                                                            <label   class="checkbox-inline i-checks" v-for="index in laborunLevels">
                                                                                <input  name="laborunLevelcheck" :code="index.value" type="checkbox" value="index.value">{{index.name}}</label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-12">
                                                                    <div class="ibox float-e-margins"
                                                                         style="margin-top: 25px">
                                                                        <p style="text-align: center;">
                                                                            <button  name="perm" data-toggle="modal"
                                                                               class="btn btn-primary"
                                                                               style="text-align: left;"
                                                                               href="#modal-formo">建会</button>
                                                                            <button name="perm" type="button"
                                                                                    class="btn  btn-primary"
                                                                                    onclick="transfer()">转移</button>
                                                                            <button name="perm" type="button"
                                                                                    class="btn  btn-primary"
                                                                                    onclick="merge()">合并</button>
                                                                            <button name="perm" type="button"
                                                                                    class="btn  btn-primary"
                                                                                    onclick="dissolve()">解散</button>


                                                                            <input type="file" id="excleFile" name="excleFile"onchange="uploadfile(this,this);" style="display:none"/>
                                                                            <button  name="perm" onclick="$('input[id=excleFile]').click();" class="btn  btn-primary">导入</button>
                                                                            <button  name="perm" type="button" onclick="templateDownload()"
                                                                                    class="btn  btn-primary mar-r15">
                                                                                下载模板
                                                                            </button>
                                                                        </p>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                           <!-- 基层工会 表格-->
                                                            <div class="table-responsive row">
                                                                <table class="table table-striped  table-hover dataTables-example">
                                                                    <thead>
                                                                    <tr>
                                                                        <th>
                                                                            <label class="checkbox-inline i-checks"
                                                                                   style="font-weight: 700">
                                                                                <input type="checkbox" class="allCheckList"
                                                                                       value="option1">
                                                                            </label>
                                                                        </th>
                                                                        <th>工会名称</th>
                                                                        <th>工会编号</th>
                                                                        <th>行政区划</th>
                                                                        <th>工会级别</th>
                                                                        <th>工会类型</th>
                                                                        <th>工会状态</th>
                                                                        <th>操作</th>
                                                                    </tr>
                                                                    </thead>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--建会 转移 跳转弹框-->
    <div id="modal-formo" class="modal fade" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content animated flipInY">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span
                            class="sr-only">Close</span></button>
                    <h4 class="modal-title">请选择一种工会级别：</h4>
                </div>
                <small class="font-bold">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-sm-10">
                                <div class="radio i-checks col-sm-4">
                                    <label class="" @click="checklaborunLevel(1)">
                                        <div class="iradio_square-green" style="position: relative;">
                                            <input type="radio" :value="1"  name='radioLaborunLevel' v-model="radioLaborunLevel"
                                                   style="position: absolute; opacity: 0;">
                                            <ins class="iCheck-helper"
                                                 tyle="position: absolute; top: 0%; left: 0%; display:
                                                  block; width: 100%; height: 100%; margin: 0px; padding:
                                                   0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins>
                                        </div>
                                        <i></i>组织工会</label>
                                </div>
                                <div class="radio i-checks col-sm-4" style="margin: 10px 0" >
                                    <label class="" @click="checklaborunLevel(2)">
                                        <div class="iradio_square-green " style="position: relative;" >
                                            <input type="radio" :value="2" name='radioLaborunLevel'  v-model="radioLaborunLevel" style="position: absolute; opacity: 0;">
                                            <ins class="iCheck-helper" style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;">
                                            </ins>
                                        </div>
                                        <i></i>产业工会</label>
                                </div>
                                <div class="radio i-checks col-sm-4" style="margin: 10px 0">
                                    <label class="" @click="checklaborunLevel(3)">
                                        <div class="iradio_square-green " style="position: relative;">
                                            <input type="radio" :value="3" name='radioLaborunLevel'  v-model="radioLaborunLevel" style="position: absolute; opacity: 0;">
                                            <ins class="iCheck-helper" style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins>
                                        </div>
                                        <i></i> 企事业工会</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a data-toggle="modal" class="btn btn-primary" onclick="establish()"
                           href="#modal-formt">确定</a>
                        <button type="button" class="btn btn-white" data-dismiss="modal" @click="establishClose">关闭</button>
                    </div>
                </small>
            </div>
            <small class="font-bold">
            </small>
        </div>
    </div>
    <transition name="fade">
        <div class="progress-bar" v-if="isShowPro">
        </div>
    </transition>
</div>
<!-- 全局js -->
<script src="js/jquery.min.js?v=2.1.4"></script>
<!--自定义js -->
<script src="js/baseaddr.js"></script>
<script src="js/bootstrap.min.js?v=3.3.6"></script>
<script src="js/plugins/jeditable/jquery.jeditable.js"></script>
<script src="js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>
<!--vue axios-->
<script src="js/vue2.5.22.js"></script>
<script src="js/ixios.0.18.0.js"></script>
<script src="js/qs.6.60.js"></script>
<script src="js/nprogress.js"></script>
<script>
    var vm = new Vue({
        el: "#treeGhlist",
            data: {
                isShowPro:false,
                Ghlist: [], //左侧工会名称
                Detailslist: [], //工会详情信息
                leageldata: {},
                laborunLevel:3,
                radioLaborunLevel:3,
                unionCh: [], //请求工会变更信息
                code: '',    //左侧列表code
                unioncode: '140000000000', //详情字段
                searchVal: '', //默认输入为空
                letter: '', //默认不排序
                original: false, //默认从小到大排列
                fileTable: null,
                fileTable2: null,
                dutyTable: null,
                fileId:'',
                dutyId :'',
                placename:'请选择工会',
                treeList:[],
                laborunTree: null,
                laborunTypes:[],
                laborunLevels:[],
                buttonpermStr:'',
                isPermButton:false,
                accountData:{
                    userName:'',
                    password:'',
                    phone:'',
                    realName:'',
                    status:1,
                    remark:''
                }
        },
        methods: {
            establishClose(){
                that.laborunLevel = 3
            },
            onTreeLaborun(obj){
                var that = this
            },
            getLaborunTreeList(){
                var that = this;
                axios({
                    method: 'post',
                    url: baseUrl + "/passLaborweb/api/laborun/union/getLaborunTree",
                    data: {
                        "laborunCode": this.unioncode
                    }
                }).then(function (data) {
                    that.treeList = data.data.data;
                });
            },
            showDetails: function (code,name) {
                this.unioncode = code
                this.searchVal = name
                getTreeList(this.unioncode)
                this.getLaborunInfo(this.unioncode)
                unionTable.draw(false);
            },
            queryLaborunFilesRecord(fileType) {
                var that = this;
                if(that.fileTable  === null){
                    that.fileTable = $('#fileRecord').dataTable({
                        sDom: '"top"i',   //去掉搜索框方法二：这种方法可以，动态获取数据时会引起错误
                        ordering: false,
                        language: lang,  //提示信息
                        bLengthChange: false,   //去掉每页显示多少条数据方法
                        autoWidth: true,  //禁用自动调整列宽
                        stripeClasses: ["odd", "even"],  //为奇偶行加上样式，兼容不支持CSS伪类的场合
                        processing: true,  //隐藏加载提示,自行处理
                        serverSide: true,  //启用服务器端分页
                        searching: false,  //禁用原生搜索
                        orderMulti: false,  //启用多列排序
                        order: [],  //取消默认排序查询,否则复选框一列会出现小箭头
                        renderer: "bootstrap",  //渲染样式：Bootstrap和jquery-ui
                        pagingType: "full_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
                        columnDefs: [{
                            "targets": 'nosort',  //列的样式名
                            "orderable": false    //包含上样式名‘nosort’的禁止排序
                        }],
                        ajax: function (data, callback, settings) {
                            //封装请求参数
                            var param = {};
                            param.size = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候
                            param.page = (data.start / data.length) + 1;
                            param.fileType = fileType;//当前页码
                            param.laborunCode=that.unioncode;
                            $.ajax({
                                type: "post",
                                url: baseUrl + "/passLaborweb/api/laborun/laborunFilesRecord/queryPage",
                                cache: false,  //禁用缓存
                                data: JSON.stringify(param),  //传入组装的参数
                                dataType: "json",
                                contentType: "application/json",
                                success: function (result) {
                                    /*     console.log(result);*/
                                    var returnData = {};
                                    returnData.draw = data.draw;//这里直接自行返回了draw计数器,应该由后台返回
                                    returnData.recordsTotal = result.data.total;//返回数据全部记录
                                    returnData.recordsFiltered = result.data.total;//后台不实现过滤功能，每次查询均视作全部结果
                                    returnData.data = result.data.content;//返回的数据列表
                                    callback(returnData);
                                    $('.dataTables-example tr td:first-child').css({"text-align": 'left'});
                                    $('.dataTables-example tr th:first-child').css({"text-align": 'left'});
                                    $('.dataTables_empty').css({"text-align": 'center'});
                                }
                            });
                        },
                        columns: [
                            {"data": "fileName"},
                            {"data": "fileConcent"},
                            {"data": "fileKindName"},
                            {
                                "render": function (data, type, row, meta) {
                                    var that = this
                                    var queryButton = ' <button  type="button" class="btn  btn-primary " data-id="' + row.id + '" onclick="fileQuery(this)" >查看</button>'
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("编辑") !== -1) {
                                        queryButton = queryButton +   '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="fileEdit(this)" > 编辑</button>'
                                    }
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("删除") !== -1) {
                                        queryButton = queryButton +   '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="fileDelete(this,2)" > 删除</button>';
                                    }
                                    return queryButton
                                },
                                "bSortable": false
                            },
                        ]
                    }).api();//此处需调用api()方法,否则返回的是JQuery对象而不是DataTables的API对象
                }

            },
            checklaborunLevel(laborunLevel){
                var that = this
                that.radioLaborunLevel = laborunLevel;
            },
            queryFilesRecord2(fileType) {
                //初始化table
                var that =  this;
                if(that.fileTable2 === null){
                    that.fileTable2 = $('#fileRecord2').dataTable({
                        sDom: '"top"i',   //去掉搜索框方法二：这种方法可以，动态获取数据时会引起错误
                        ordering: false,
                        language: lang,  //提示信息
                        bLengthChange: false,   //去掉每页显示多少条数据方法
                        autoWidth: true,  //禁用自动调整列宽
                        stripeClasses: ["odd", "even"],  //为奇偶行加上样式，兼容不支持CSS伪类的场合
                        processing: true,  //隐藏加载提示,自行处理
                        serverSide: true,  //启用服务器端分页
                        searching: false,  //禁用原生搜索
                        orderMulti: false,  //启用多列排序
                        order: [],  //取消默认排序查询,否则复选框一列会出现小箭头
                        renderer: "bootstrap",  //渲染样式：Bootstrap和jquery-ui
                        pagingType: "full_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
                        columnDefs: [{
                            "targets": 'nosort',  //列的样式名
                            "orderable": false    //包含上样式名‘nosort’的禁止排序
                        }],
                        ajax: function (data, callback, settings) {
                            //封装请求参数
                            var param = {};
                            param.size = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候
                            param.page = (data.start / data.length) + 1;
                            param.fileType = fileType;//当前页码
                            param.laborunCode=that.unioncode;
                            $.ajax({
                                type: "post",
                                url: baseUrl + "/passLaborweb/api/laborun/laborunFilesRecord/queryPage",
                                cache: false,  //禁用缓存
                                data: JSON.stringify(param),  //传入组装的参数
                                dataType: "json",
                                contentType: "application/json",
                                success: function (result) {
                                    /*     console.log(result);*/
                                    var returnData = {};
                                    returnData.draw = data.draw;//这里直接自行返回了draw计数器,应该由后台返回
                                    returnData.recordsTotal = result.data.total;//返回数据全部记录
                                    returnData.recordsFiltered = result.data.total;//后台不实现过滤功能，每次查询均视作全部结果
                                    returnData.data = result.data.content;//返回的数据列表
                                    callback(returnData);
                                    $('.dataTables-example tr td:first-child').css({"text-align": 'left'});
                                    $('.dataTables-example tr th:first-child').css({"text-align": 'left'});
                                    $('.dataTables_empty').css({"text-align": 'center'});
                                }
                            });
                        },
                        columns: [
                            {"data": "fileName"},
                            {"data": "fileConcent"},
                            {"data": "fileKindName"},
                            {
                                "render": function (data, type, row, meta) {
                                    var that = this
                                    var queryButton = ' <button  type="button" class="btn  btn-primary " data-id="' + row.id + '" onclick="fileQuery(this)" >查看</button>'
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("编辑") !== -1) {
                                        queryButton = queryButton +   '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="fileEdit(this)" > 编辑</button>'
                                    }
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("删除") !== -1) {
                                        queryButton = queryButton +   '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="fileDelete(this,3)" > 删除</button>';
                                    }
                                    return queryButton

                                },
                                "bSortable": false
                            },
                        ]
                    }).api();//此处需调用api()方法,否则返回的是JQuery对象而不是DataTables的API对象
                }

            },
            queryDuty() {
                var that = this
                if(that.dutyTable === null ){
                    that.dutyTable = $('#queryDuty').dataTable({
                        sDom: '"top"i',   //去掉搜索框方法二：这种方法可以，动态获取数据时会引起错误
                        ordering: false,
                        language: lang,  //提示信息
                        bLengthChange: false,   //去掉每页显示多少条数据方法
                        autoWidth: true,  //禁用自动调整列宽
                        stripeClasses: ["odd", "even"],  //为奇偶行加上样式，兼容不支持CSS伪类的场合
                        processing: true,  //隐藏加载提示,自行处理
                        serverSide: true,  //启用服务器端分页
                        searching: false,  //禁用原生搜索
                        orderMulti: false,  //启用多列排序
                        order: [],  //取消默认排序查询,否则复选框一列会出现小箭头
                        renderer: "bootstrap",  //渲染样式：Bootstrap和jquery-ui
                        pagingType: "full_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
                        columnDefs: [{
                            "targets": 'nosort',  //列的样式名
                            "orderable": false    //包含上样式名‘nosort’的禁止排序
                        }],
                        ajax: function (data, callback, settings) {
                            //封装请求参数
                            var param = {};
                            param.size = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候
                            param.page = (data.start / data.length) + 1;
                            param.laborunCode=that.unioncode;
                            $.ajax({
                                type: "post",
                                url: baseUrl + "/passLaborweb/api/laborun/laborunDuty/queryPage",
                                cache: false,  //禁用缓存
                                data: JSON.stringify(param),  //传入组装的参数
                                dataType: "json",
                                contentType: "application/json",
                                success: function (result) {
                                    /*     console.log(result);*/
                                    var returnData = {};
                                    returnData.draw = data.draw;//这里直接自行返回了draw计数器,应该由后台返回
                                    returnData.recordsTotal = result.data.total;//返回数据全部记录
                                    returnData.recordsFiltered = result.data.total;//后台不实现过滤功能，每次查询均视作全部结果
                                    returnData.data = result.data.content;//返回的数据列表
                                    callback(returnData);
                                    $('.dataTables-example tr td:first-child').css({"text-align": 'left'});
                                    $('.dataTables-example tr th:first-child').css({"text-align": 'left'});
                                    $('.dataTables_empty').css({"text-align": 'center'});
                                }
                            });
                        },
                        columns: [
                            {"data": "dutyName"},
                            {"data": "memName"},
                            {"data": "memNumber"},
                            {"data": "dutyTime"},
                            {
                                "render": function (data, type, row, meta) {
                                    var queryButton = '<button type="button" class="btn  btn-primary" data-id="' + row.id + '" onclick="queryDuty(this)">查看</button>' ;
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("更换") !== -1) {
                                        queryButton = queryButton +  '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="dutyEdit(this)" >更换</button>'
                                    }
                                    if (!vm.isPermButton || vm.buttonpermStr.indexOf("删除") !== -1) {
                                        queryButton = queryButton + '<button type="button" style="margin-left: 10px" class="btn  btn-primary" data-id="' + row.id + '" onclick="dutyDelete(this)" > 删除</button>';
                                    }
                                    return queryButton
                                },
                                "bSortable": false
                            },
                        ]
                    }).api();//此处需调用api()方法,否则返回的是JQuery对象而不是DataTables的API对象
                }else{
                    that.dutyTable.draw(false);
                }

            },
            queryLaborunChRecord (){
                var that = this
                axios({
                    method: 'post',
                    url: baseUrl + "/passLaborweb/api/laborun/laborunChRecord/queryPage",
                    data: {
                        "laborunCode": that.unioncode
                    }
                }).then(function (res) {
                    if(res.data.code==='0' && res.data.data !==null && res.data.data.content !==null) {
                        that.unionCh = res.data.data.content;
                    }
                });
            },
            querylaborunLegal(){
                var that = this
                axios({
                    method: 'post',
                    url: baseUrl + "/passLaborweb/api/laborun/laborunLegal/query",
                    data: {
                        "laborunCode": that.unioncode
                    }
                }).then(function (res) {
                    if(res.data.code==='0' && res.data.data !==null){
                        that.leageldata = res.data.data;
                       $("#updateLeaGelCalss").show()
                        $("#addLeaGelCalss").hide()

                    }else{
                        $("#updateLeaGelCalss").hide()
                        $("#addLeaGelCalss").show()
                    }
                });
            },
            queryLaborunDetail(){
                var that = this;
                that.getLaborunInfo(that.unioncode)
            },
            getLaborunInfo(laborunCode){
                var that = this
                axios({
                    method: 'post',
                    url: baseUrl + "/passLaborweb/api/laborun/union/query",
                    data: {
                        "laborunCode": laborunCode
                    }
                }).then(function (res) {
                    if(res.data.code==='0'){
                        that.Detailslist = res.data.data;
                        that.placename = that.Detailslist.laborunName
                        if(that.Detailslist !==null && that.Detailslist.laborunLevel ==='3'){
                            $('#unitClass').show()
                            $('#buildWayclass').show()
                            $('#unitTypeclass').hide()
                        }else{
                            $('#unitClass').hide()
                            $('#unitTypeclass').show()
                            $('#buildWayclass').hide()
                        }
                    }
                });
            },
            getButtonsPerm() {
                var that = this
                axios({
                    method: 'post',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    url: userUrl + "/sso/ssoResource/getchildSysResource",
                    data: Qs.stringify({
                        "code": window.localStorage.getItem('labornsystemCode')
                    })
                }).then(function (res) {
                    if(res.data.code === '0'){
                        if(res.data.data.buttonPerm !== undefined){
                           var buttonPermMap = res.data.data.buttonPerm;
                            var buttonperms = $("button[name=perm]");
                            that.isPermButton = true
                            if (buttonPermMap !== undefined && buttonPermMap !==null && buttonPermMap.hasOwnProperty("S1006005")) {
                                var buttonPerm = buttonPermMap["S1006005"]
                                that.buttonpermStr = buttonPerm;
                                if (buttonperms.length > 0) {
                                    for (var i = 0; i < buttonperms.length; i++) {
                                        var text = buttonperms[i].innerText.replace(/\s/g, "")
                                        if (buttonPerm.indexOf(text) === -1) {
                                            $(buttonperms[i]).attr("style", "display:none;");
                                        }
                                    }
                                }
                            }else{
                                if (buttonperms.length > 0) {
                                    for (var i = 0; i < buttonperms.length; i++) {
                                        $(buttonperms[i]).attr("style", "display:none;");
                                    }
                                }
                            }
                        }
                    }
                });

            },
            getSystemDictionary(){
                var that = this
                axios({
                    method: 'post',
                    headers: {'Content-Type': 'application/json'},
                    url: baseUrl + "/passLaborweb/api/laborun/systemDictionary/query",
                    data: {
                        "sn": "laborunType,laborunLevel"
                    }
                }).then(function (res) {
                    if(res.data.code ==='0'){
                        $.each(res.data.data, function (index, item) {
                            if(item.laborunType !== undefined){
                                that.laborunTypes = item.laborunType;
                            }
                            if(item.laborunLevel !== undefined){
                                that.laborunLevels = item.laborunLevel;
                            }
                        })
                    }
                });
            },
            getLaborunList(){
                var that = this;
                axios({
                    method: 'get',
                    url: baseUrl + "/passLaborweb/api/laborun/union/getLaborunList",
                    data: {
                        "laborunCode":  that.unioncode
                    }
                }).then(function (data) {
                    that.Ghlist = data.data.data;
                });
            },
            queryAccount(){
                var that = this
                axios({
                    method: 'post',
                    headers: {'Content-Type': 'application/json'},
                    url: userUrl + "/sso/ssoUser/queryPage",
                    data: {
                        "ext1":  that.unioncode,
                        "isAdmin":  1
                    }
                }).then(function (res) {
                    if(res.data.code==='0' && res.data.data !==null && res.data.data.total >= '1') {
                        that.accountData = res.data.data.content[0];
                    }
                });

            },
            saveAccount(){
                var that = this
                axios({
                    method: 'post',
                    headers: {'Content-Type': 'application/json'},
                    url: userUrl + "/sso/ssoUser/addAdminAccount",
                    data: JSON.stringify({
                        "ext1":  that.unioncode,
                        "ext2":  that.Detailslist.laborunName,
                        "userName" : $("#userName").val(),
                        "password" : $("#password").val(),
                        "phone" : $("#phone").val(),
                        "realName" :$("#realName").val(),
                        "status" :$("#status").val(),
                        "remark" :$("#remark").val(),
                        "type":5,
                        "systemCode": window.localStorage.getItem("labornsystemCode")
                    })
                }).then(function (res) {
                    if(res.data.code==='0') {
                        layer.msg("保存成功", {icon: 1, time: 1000})
                        that.queryAccount()
                    }else{
                        layer.msg(res.data.msg+",请联系上级工会管理员", {icon: 2, time: 3000})
                    }
                });
            }

        },
        mounted() {
            /*查看工会详情*/
            var that = this;
            that.unioncode = window.localStorage.getItem("laborunCode");
            if(that.unioncode === "undefined" || that.unioncode === null || that.unioncode===''){
                that.unioncode ='140000000000'
            }
            that.queryLaborunDetail()
            /*获取工会名称编号*/
            that.getLaborunList()
            that.getButtonsPerm()
            that.getSystemDictionary()
        },
        computed: {
            officeSum: function () {
                return parseInt(this.leageldata.office)
                    + parseInt(this.leageldata.activities)
                    + parseInt(this.leageldata.otherPlace);
            },
            capitalSum: function () {
                return parseFloat(this.leageldata.fixedCapital)
                    + parseFloat(this.leageldata.workingCapital)
                    + parseFloat(this.leageldata.otherCapital);
            },
            list: function () {
                var that = this;
                var arrByZM = [];
                for (var i = 0; i < this.Ghlist.length; i++) {
                    if (this.Ghlist[i].laborun_name.search(this.searchVal) != -1) {
                        arrByZM.push(that.Ghlist[i]);
                    }
                }
                if (this.letter != '') {
                    arrByZM.sort(function (a, b) {
                        if (that.original) {
                            return b[that.letter] - a[that.letter];
                        } else {
                            return a[that.letter] - b[that.letter];
                        }
                    });
                }
                return arrByZM;
            }
        }

    });
</script>
<!--模糊搜索-->
<script src="js/jquery.combo.select.js"></script>
<!--高级搜索-->
<script>
    $('.more').on('click', function () {
        $(this).toggleClass("moreup");
        $('.morecheackboxo').slideToggle('slow');
        $('.morecheackboxt').slideToggle('slow');
        if ($(this).attr('class') == 'more moreup') {
            $(this).children('span').text('点击收起∨');
        } else {
            $(this).children('span').text('高级搜索>');
        }

    })
</script>
<script src="js/plugins/layer/layer.min.js"></script>
<script>layer.config({skin: 'my-skin'})</script>
<!--建会，转移 点击弹框-->
<script>
    function establish() {

        var that = this
        var  levelradio= $("input[name=radioLaborunLevel]");
        if(levelradio !== undefined && levelradio.length !==0) {
            for (var i = 0; i < levelradio.length; i++) {
                if($(levelradio)[i].checked){
                    that.vm.radioLaborunLevel = parseInt($(levelradio[i])[0].attributes[2].nodeValue)
                    $($('.modal-backdrop')[0]).hide('slow');
                    $("#modal-formo").modal('hide');
                    var  url =""
                    var  title = "建会(组织工会)"
                    var param = that.vm.Detailslist.laborunCode+'&laborunLevel='+that.vm.radioLaborunLevel+'&laborunName='+that.vm.Detailslist.laborunName;
                    if(that.vm.radioLaborunLevel ===1){
                        var  title = "建会(组织工会)"
                        url = 'union_addinfo.html?laborunCode='+ param;
                    }else if(that.vm.radioLaborunLevel ===2){
                        var  title = "建会(产业工会)"
                        url = 'union_addinfo.html?laborunCode='+ param;
                    }else if(that.vm.radioLaborunLevel ===3){
                        var  title = "建会(企事业工会)"
                        url = 'union_addinfo_unit.html?laborunCode='+ param;
                    }
                    layer.open({
                        type: 2,
                        title: title,
                        fixed: false,
                        shadeClose: true, //点击遮罩关闭层
                        area: ['100%', '100%'],
                        content: url,
                        shift: 0,
                        offset: 0,
                        end: function () {
                            that.unionTable.draw(false);
                            that.getTreeList(that.vm.unioncode)
                        }
                    })
                    break
                }
            }
        }

    }

    function transfer() {
        var that  = this
        layer.open({
            type: 2,
            title: '转移',
            fixed: false,
            shadeClose: true, //点击遮罩关闭层
            area: ['100%', '100%'],
            content: 'union_transfer.html',
            shift: 0,
            offset: 0,
            end: function () {
                that.unionTable.draw(false);
                that.getTreeList(that.vm.unioncode);
            }
        })
    }

    function merge() {
        var that = this
        layer.open({
            type: 2,
            title: '合并',
            fixed: false,
            shadeClose: true, //点击遮罩关闭层
            area: ['100%', '100%'],
            content: 'union_merge.html',
            shift: 0,
            offset: 0,
            end: function () {
                that.unionTable.draw(false);
                that.getTreeList(that.vm.unioncode)
            }
        })
    }

    function dissolve() {
        var that = this
        layer.open({
            type: 2,
            title: '解散',
            fixed: false,
            shadeClose: true, //点击遮罩关闭层
            area: ['100%', '100%'],
            content: 'union-dissolution.html',
            shift: 0,
            offset: 0,
            end: function () {
                that.unionTable.draw(false);
            }
        })
    }

    function addfile(fileType) {
        var that = this
        layer.open({
            type: 2,
            title: '添加文件',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'union-addfliemask.html?fileType=' + fileType +'&laborunCode='+that.vm.Detailslist.laborunCode,
            end: function () {
                if(that.vm.fileTable !=null){
                    that.vm.fileTable.draw(false);
                }
                if(that.vm.fileTable2 !=null){
                    that.vm.fileTable2.draw(false);
                }
            }
        })
    }

    function fileEdit(obj) {
        var id = $(obj)[0].attributes[3].nodeValue;
        var that = this
        layer.open({
            type: 2,
            title: '编辑文件',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'union-editfile.html?id=' + id,
            end: function () {
                if(that.vm.fileTable !=null){
                    that.vm.fileTable.draw(false);
                }
                if(that.vm.fileTable2 !=null){
                    that.vm.fileTable2.draw(false);
                }
            }
        })
    }

    function fileQuery(obj) {
        var id = $(obj).data("id");
        var that = this
        layer.open({
            type: 2,
            title: '查看',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'union-queryfile.html?id=' + id
        })
    }

    function fileDelete(obj,fileType) {
        var _this = this
        layer.confirm('确定要删除吗', {
            skin : "my-skin",
            btn: ['确定', '取消']
        }, function () {
            var that = this
            var id = $(obj).data("id");
            axios({
                method: 'post',
                url: baseUrl + "/passLaborweb/api/laborun/laborunFilesRecord/delete",
                data: {
                    "id": id
                }
            }).then(function (res) {
                if (res.data.code === '0') {
                    layer.msg("删除成功", {icon: 1, time: 2000})
                    if(fileType === 2){
                        _this.vm.fileTable.draw(false);
                    }else{
                        _this.vm.fileTable2.draw(false);
                    }
                    layer.close(layer.index);
                } else {
                   layer.msg(res.data.msg, {icon: 2, time: 3000})
                }
            });
        }, function () {
            layer.close(layer.index);
        })
    }

    function addDuty() {
        var that = this
        layer.open({
            type: 2,
            title: '添加任职',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'duty_add.html?laborunCode='+that.vm.Detailslist.laborunCode,
            end: function () {
                that.vm.dutyTable.draw(false);
            }
        })
    }
    function getDutyRecord() {
        var that = this
        layer.open({
            type: 2,
            title: '任职记录查询',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'duty_record.html?laborunCode='+that.vm.Detailslist.laborunCode
        })
    }

    function queryDuty(obj) {
        var id = $(obj)[0].attributes[2].nodeValue;
        layer.open({
            type: 2,
            title: '查看任职',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'duty_query.html?id='+id
        })
    }

    function dutyEdit(obj) {
        var that = this
        var id = $(obj)[0].attributes[3].nodeValue;
        layer.open({
            type: 2,
            title: '编辑任职',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'duty_edit.html?id='+id,
            end: function () {
                that.vm.dutyTable.draw(false);
            }
        })
    }

    function dutyDelete(obj) {
        var _this = this
        layer.confirm('确定要删除吗', {
            skin : "my-skin",
            btn: ['确定', '取消']
        }, function () {
            var id = $(obj)[0].attributes[3].nodeValue;
            var that = this
            axios({
                method: 'post',
                url: baseUrl + "/passLaborweb/api/laborun/laborunDuty/delete",
                data: {
                    "id": id
                }
            }).then(function (res) {
                if (res.data.code === '0') {
                    layer.msg("删除成功", {icon: 1, time: 1000})
                    _this.vm.dutyTable.draw(false);
                    layer.close(layer.index);
                } else {
                    layer.msg(res.data.msg, {icon: 2, time: 3000})
                }
            });
        }, function () {
            layer.close(layer.index);
        })
    };

    function templateDownload () {
        window.location.href= baseUrl + "/passLaborweb/api/laborun/file/download?fileName=excel/建会模板.xlsx";
    }



</script>
<!-- jQuery UI -->
<script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>
<!--树状图-->
<script src="js/plugins/treeview/bootstrap-treeview.js"></script>
<!--
<script src="js/demo/treeview-demo.js"></script>
-->
<!-- iCheck -->
<script src="js/plugins/validate/jquery.validate.min.js"></script>
<script src="js/demo/form-validate-sytle.js"></script>
<script src="js/plugins/iCheck/icheck.min.js"></script>

<script>
    var unionTable;
    window.onload = function () {
        var that = this;
        that.getTreeList(that.vm.unioncode)
        unionTable = $('.dataTables-example').dataTable({
            sDom: '"top"i',   //去掉搜索框方法二：这种方法可以，动态获取数据时会引起错误
            ordering: false,
            bLengthChange: false,   //去掉每页显示多少条数据方法
            language: lang,  //提示信息
            autoWidth: true,  //禁用自动调整列宽
            stripeClasses: ["odd", "even"],  //为奇偶行加上样式，兼容不支持CSS伪类的场合
            processing: true,  //隐藏加载提示,自行处理
            serverSide: true,  //启用服务器端分页
            searching: false,  //禁用原生搜索
            orderMulti: false,  //启用多列排序
            order: [],  //取消默认排序查询,否则复选框一列会出现小箭头
            renderer: "bootstrap",  //渲染样式：Bootstrap和jquery-ui
            pagingType: "full_numbers",  //分页样式：simple,simple_numbers,full,full_numbers
            columnDefs: [{
                "targets": 'nosort',  //列的样式名
                "orderable": false    //包含上样式名‘nosort’的禁止排序
            }],
            ajax: function (data, callback, settings) {
                //封装请求参数
                var param = {};
                param.size = data.length;//页面显示记录条数，在页面显示每页显示多少项的时候
                param.page = (data.start / data.length) + 1;//当前页码
                param.parentlaborun = that.vm.unioncode
                if ($(".UnionName select option:selected").val() != "") {
                    param.laborunName = $(".UnionName select option:selected").text();
                }

                if ($(".UnionCode select option:selected").val() != "") {
                    param.laborunCode = $(".UnionCode select option:selected").text();
                }
                var laborunTypeStrs = [];
                var laborunTypecheckList = $("input[name=laborunTypecheck]");
                if(laborunTypecheckList!== undefined && laborunTypecheckList.length>0){
                    for(var i=0;i< laborunTypecheckList.length;i++){
                        if( $(laborunTypecheckList[i])[0].checked){
                            laborunTypeStrs.push($(laborunTypecheckList[i])[0].attributes[1].nodeValue);
                        }
                    }
                }
                if(laborunTypeStrs.length>0){
                    param.laborunTypeList = laborunTypeStrs.join(",")
                }
                var laborunLevelStrs = [];
                var laborunLevelcheckList = $("input[name=laborunLevelcheck]");
                if(laborunLevelcheckList!== undefined && laborunLevelcheckList.length>0){
                    for(var i=0;i< laborunLevelcheckList.length;i++){
                        if( $(laborunLevelcheckList[i])[0].checked){
                            laborunLevelStrs.push($(laborunLevelcheckList[i])[0].attributes[1].nodeValue);
                        }
                    }
                }
                if(laborunLevelStrs.length>0){
                    param.laborunLevelList = laborunLevelStrs.join(",")
                }
                $.ajax({
                    type: "post",
                    url: baseUrl + "/passLaborweb/api/laborun/union/queryPage",
                    cache: false,  //禁用缓存
                    data: JSON.stringify(param),  //传入组装的参数
                    dataType: "json",
                    contentType: "application/json",
                    success: function (result) {
                        var returnData = {};
                        returnData.draw = data.draw;//这里直接自行返回了draw计数器,应该由后台返回
                        returnData.recordsTotal = result.data.total;//返回数据全部记录
                        returnData.recordsFiltered = result.data.total;//后台不实现过滤功能，每次查询均视作全部结果
                        returnData.data = result.data.content;//返回的数据列表
                        callback(returnData);
                        $('.i-checks').iCheck({
                            checkboxClass: 'icheckbox_square-green',
                            radioClass: 'iradio_square-green',
                        });



                        $('select').comboSelect();
                        $(".allCheck").on('ifChanged', function (event) {
                            var selectThis = $(this).parents('label').nextAll().find('input[type=checkbox]');
                            selectThis.prop("checked", $(this).prop("checked"));
                            if ($(this)[0].checked) {
                                selectThis.parent().addClass("checked");
                            } else {
                                selectThis.parent().removeClass("checked");
                            }
                        });
                        $(".allCheckList").on('ifChanged', function (event) {
                            var selectThis = $(this).parents('thead').next('tbody').find('input[type=checkbox]');
                            selectThis.prop("checked", $(this).prop("checked"));
                            if ($(this)[0].checked) {
                                selectThis.parent().addClass("checked");
                            } else {
                                selectThis.parent().removeClass("checked");
                            }

                        });

                        $('.dataTables-example tr td:first-child').css({"text-align": 'left'});
                        $('.dataTables-example tr th:first-child').css({"text-align": 'left'});
                        $('.dataTables_empty').css({"text-align": 'center'});
                    }
                });
            },
            //列表表头字段
            columns: [
                {
                    "render": function () {
                        return '<input type="checkbox" class="i-checks iCheck-helper trcheck" name="input[]">';
                    },
                    "bSortable": false
                },
                {"data": "laborunName"},
                {"data": "laborunCode"},
                {"data": "administratName"},
                {"data": "laborunLevelText"},
                {"data": "laborunTypeText"},
                {"data": "laborunStatusText"},
                {
                    "render": function (data, type, row, meta) {
                        var queryButton = ' <button  type="button" class="btn  btn-primary " data-type="' + row.laborunLevel+ '" onclick="query(this)" >查看</button>'
                        if (!vm.isPermButton || vm.buttonpermStr.indexOf("编辑") !== -1) {
                            queryButton = queryButton + ' <button  name="perm" type="button" class="btn  btn-primary" data-id="' + row.laborunCode+ '" data-type="' + row.laborunLevel+ '" onclick="editLaborun(this)" >编辑 </button>'
                        }
                        return queryButton
                    },
                    "bSortable": false
                },
            ]
        }).api();//此处需调用api()方法,否则返回的是JQuery对象而不是DataTables的API对象
    };
    function Search() {
        unionTable.draw(false);
    }


    $('#treeLaborun').on('nodeSelected',function(event, node) {
        vm.unioncode = node.laborunCode;
        vm.getLaborunInfo(node.laborunCode);
        unionTable.draw(false);
    });

   /* $('#organLaborun').on('nodeSelected',function(event, node) {
        if(node.laborunCode !=='0'){
            vm.unioncode = node.laborunCode
            axios({
                method: 'post',
                url: baseUrl + "/passLaborweb/api/laborun/union/query",
                data: {
                    "laborunCode": node.laborunCode
                }
            }).then(function (data) {
                vm.Detailslist = data.data.data;
                vm.placename = vm.Detailslist.laborunName
            });
        }

    });
    $('#industryLaborun').on('nodeSelected',function(event, node) {
        if(node.laborunCode !=='0') {
            vm.unioncode = node.laborunCode
            axios({
                method: 'post',
                url: baseUrl + "/passLaborweb/api/laborun/union/query",
                data: {
                    "laborunCode": node.laborunCode
                }
            }).then(function (data) {
                vm.Detailslist = data.data.data;
                vm.placename = vm.Detailslist.laborunName
            });
        }
    });
    $('#unitLaborun').on('nodeSelected',function(event, node) {
        if(node.laborunCode !=='0') {
            vm.unioncode = node.laborunCode
            axios({
                method: 'post',
                url: baseUrl + "/passLaborweb/api/laborun/union/query",
                data: {
                    "laborunCode": node.laborunCode
                }
            }).then(function (data) {
                vm.Detailslist = data.data.data;
                vm.placename = vm.Detailslist.laborunName
            });
        }
    });*/
    function getTreeList(laborunCode){
        var that = this
        axios({
            method: 'post',
            url: baseUrl + "/passLaborweb/api/laborun/union/getLaborunTree",
            data: {
                "laborunCode": laborunCode
            }
        }).then(function (res) {
            if (res.data.code === '0'){
                var treeList = res.data.data.childrenList;
                if(treeList !== undefined && treeList.length>0){
                    that.vm.laborunTree = $('#treeLaborun').treeview({
                        expandIcon: 'glyphicon glyphicon-plus-sign',
                        collapseIcon: 'glyphicon glyphicon-minus-sign',
                        nodeIcon: 'fa fa fa-sitemap',
                        data: treeList
                    });
                   /* $('#organLaborun').treeview({
                        expandIcon: 'glyphicon glyphicon-plus-sign',
                        collapseIcon: 'glyphicon glyphicon-minus-sign',
                        nodeIcon: 'fa fa fa-sitemap',
                        expanded:0,
                        data: res.data.data.oranList
                    });

                    $('#industryLaborun').treeview({
                        expandIcon: 'glyphicon glyphicon-plus-sign',
                        collapseIcon: 'glyphicon glyphicon-minus-sign',
                        nodeIcon: 'fa fa fa-sitemap',
                        data: res.data.data.indutryList
                    });
                    $('#unitLaborun').treeview({
                        expandIcon: 'glyphicon glyphicon-plus-sign',
                        collapseIcon: 'glyphicon glyphicon-minus-sign',
                        nodeIcon: 'fa fa fa-sitemap',
                        data: res.data.data.unitList
                    });*/
                }
            }
        });
    }

    $('#reset').on('click', function () {
        $('#laborunCode').val('');
        $('#laborunName').val('');
        $("input[name=laborunLevelall]").iCheck('uncheck');
        $("input[name=laborunTypeall]").iCheck('uncheck');
        $("input[name=laborunTypecheck]").prop("checked", false);
        $("input[name=laborunLevelcheck]").prop("checked", false);

        unionTable.draw(false);
    })



</script>

<!--基层工会表格 查看 编辑-->
<script>
    // 查看功能
    function query(obj) {
        var SeaCode = $(obj).parents('tr').children().eq(2).text();
        var type = $(obj).data("type")
        var content = 'union_basicinfo.html?seacode=' + SeaCode
        if(type ===3){
            content = 'union_unit_info.html?seacode=' + SeaCode
        }
        layer.open({
            type: 2,
            title: '',
            shadeClose: false,
            area: ['100%', '100%'],
            content:  content
        })
    }

    function editLaborun(obj) {
        var that = this
        var laborunCode = $(obj).data("id");
        var type = $(obj).data("type")
        var content = 'union_detailsedit.html?seacode=' + laborunCode
        if(type ===3){
            content = 'union_unit_edit.html?seacode=' + laborunCode
        }
        layer.open({
            type: 2,
            title: '工会编辑',
            shadeClose: true,
            area: ['100%', '100%'],
            content: content,
            end: function () {
                that.unionTable.draw(false);
            }
        })
    }

    function updateLegal(){
        var that = this
        if(that.vm.leageldata.id ===undefined){
            layer.msg("请先添加法人资格再进行变更",{icon: 2, time: 1500})
        }else{
            layer.open({
                type: 2,
                title: '法人资格',
                shadeClose: true,
                area: ['100%', '100%'],
                content: 'legal_edit.html?id='+that.vm.leageldata.id,
                end: function () {
                    that.vm.querylaborunLegal()
                }
            })
        }

    }

    function addLegal(){
        var that = this
        layer.open({
            type: 2,
            title: '法人资格',
            shadeClose: true,
            area: ['100%', '100%'],
            content: 'legal_add.html?laborunCode='+that.vm.unioncode,
            end: function () {
                that.vm.querylaborunLegal()
            }
        })


    }

    function legelRecord(){

    }
    function uploadfile(obj, file) {
        var that = this
        if (file.files && file.files[0]) {
            if (file.files.length === 1) {
                let file1 = file.files[0];
                var fileName = file1.name.substring(file1.name.lastIndexOf(".")+1).toLowerCase();
                if(fileName !="xls" && fileName !="xlsx"){
                    layer.msg("请选择execl格式文件上传！",{icon: 2, time: 3000})
                }else{
                    var that = this
                    var param = new FormData();
                    param.append('file', file1, file1.name);// 通过append向form对象添加数据

                    let config = {
                        headers: {'Content-Type': 'multipart/form-data'}
                    };
                    that.vm.isShowPro = true;
                    NProgress.start()
                    axios.post(baseUrl + '/passLaborweb/api/laborun/union/import', param, config)
                        .then(res => {
                            if (res.data.code === '0') {
                                if(res.data.data.faultNum === '0' &&  res.data.data.updateNum === '0'){
                                    that.vm.isShowPro = false;
                                    layer.msg("导入成功",{icon: 1, time: 1000})
                                    that.unionTable.draw(false);
                                }else{
                                    var url = baseUrl + "/passLaborweb/api/laborun/file/download?fileName="+res.data.data.errorXlsName
                                    layer.open({
                                        type: 1,
                                        offset: 1,
                                        title: '导入说明',
                                        id: 'layerDemo'+1,
                                        content: '<div style="padding: 20px 100px;">导入存在失败'+ res.data.data.faultNum + '条数据请<a href='+ url +'>下载</a>失败数据说明</div>',
                                        btn: '确定',
                                        shade: 0,
                                        yes: function(){
                                            layer.closeAll();
                                        }
                                    });
                                }
                            } else {
                                layer.msg(res.data.msg,{icon: 2, time: 3000})
                            }
                            NProgress.done()
                        })
                }

                $('input[id=excleFile]').val(null);
            }
        }
    }


    $().ready(function () {
        var icon = "<i class='fa fa-times-circle'></i> ";
        $("#accountForm").validate({
            onsubmit:true,

            rules: {
                userName: "required",
                password: "required",
                realName: "required",
                phone: {
                    "required":true,
                    isMobile : true,
                    minlength:11,
                },
                remark: {
                    maxlength:200
                }
            },
            messages: {
                userName: icon + "请输入用户账号",
                password: icon + "请输入密码",
                realName: icon + "请输入姓名",
                remark:{
                    maxlength:icon + "长度不大于200"
                },
                phone:{
                    required :icon + "请输入联系方式",
                    minlength : "手机号不能小于11个数字",
                    isMobile : "请正确填写手机号码"
                }
            },
            submitHandler: function (form) {
                vm.saveAccount();

            }
        });
    })


</script>


</body>
</html>
